# Google Sheets Orders 데이터 다운로더 (GUI 버전)

이 프로그램은 Google Sheets의 Orders 시트 데이터를 엑셀 파일로 다운로드하는 GUI 애플리케이션입니다.

## 🖥️ GUI 기능

### 📋 주요 기능

-   **직관적인 GUI 인터페이스**: 마우스 클릭으로 쉽게 사용
-   **다운로드 경로 지정**: 원하는 폴더에 파일 저장 가능
-   **연결 테스트**: 다운로드 전 연결 상태 확인
-   **실시간 로그**: 작업 진행 상황을 실시간으로 확인
-   **설정 저장/불러오기**: 자주 사용하는 설정을 저장하고 재사용
-   **멀티스레딩**: UI가 멈추지 않고 백그라운드에서 작업 수행

### 🎯 사용자 인터페이스

#### 설정 섹션

-   **인증 파일**: Google Cloud Console에서 다운로드한 JSON 파일 선택
-   **스프레드시트 ID**: Google Sheets URL에서 추출한 ID
-   **워크시트 이름**: 다운로드할 시트 이름 (기본값: Orders)
-   **다운로드 경로**: 엑셀 파일을 저장할 폴더 선택
-   **파일명 접두사**: 저장될 파일명의 접두사 설정

#### 버튼 섹션

-   **🔍 연결 테스트**: Google Sheets API 연결 상태 확인
-   **📥 데이터 다운로드**: 실제 데이터 다운로드 실행
-   **💾 설정 저장**: 현재 설정을 JSON 파일로 저장
-   **📂 설정 불러오기**: 저장된 설정 파일 불러오기

#### 로그 섹션

-   **실시간 로그**: 작업 진행 상황을 타임스탬프와 함께 표시
-   **진행 상태**: 현재 작업 상태 표시

## 🚀 설치 및 실행

### 1. 필요한 라이브러리 설치

```bash
pip install pandas gspread google-auth openpyxl
```

### 2. GUI 프로그램 실행

```bash
python google_sheets_downloader_gui.py
```

## 📖 사용 방법

### 1단계: Google Cloud Console 설정

1. [Google Cloud Console](https://console.cloud.google.com/)에 접속
2. 새 프로젝트 생성 또는 기존 프로젝트 선택
3. Google Sheets API 활성화:
    - "API 및 서비스" → "라이브러리" → "Google Sheets API" 검색 후 활성화

### 2단계: 서비스 계정 생성

1. "API 및 서비스" → "사용자 인증 정보" → "사용자 인증 정보 만들기" → "서비스 계정"
2. 서비스 계정 이름 입력 (예: "sheets-downloader")
3. "키 만들기" → "JSON" 선택
4. 다운로드된 JSON 파일을 안전한 위치에 저장

### 3단계: Google Sheets 권한 설정

1. 대상 Google Sheets 파일 열기
2. "공유" 버튼 클릭
3. 다운로드한 JSON 파일의 `client_email` 값을 복사
4. 해당 이메일 주소를 편집자 권한으로 추가

### 4단계: GUI에서 설정

1. **인증 파일 선택**: "찾기" 버튼을 클릭하여 다운로드한 JSON 파일 선택
2. **스프레드시트 ID 확인**: 기본값이 올바른지 확인 (필요시 수정)
3. **워크시트 이름 확인**: "Orders"가 올바른지 확인
4. **다운로드 경로 선택**: "찾기" 버튼을 클릭하여 저장할 폴더 선택
5. **파일명 접두사 설정**: 원하는 접두사 입력 (기본값: orders_data)

### 5단계: 연결 테스트

1. **🔍 연결 테스트** 버튼 클릭
2. 로그 섹션에서 연결 상태 확인
3. 성공하면 "✅ 연결 성공!" 메시지와 데이터 행 수 표시

### 6단계: 데이터 다운로드

1. **📥 데이터 다운로드** 버튼 클릭
2. 로그 섹션에서 진행 상황 확인
3. 완료되면 성공 메시지와 함께 파일 경로 표시

## 💾 설정 저장/불러오기

### 설정 저장

1. 원하는 설정을 모두 입력
2. **💾 설정 저장** 버튼 클릭
3. 저장할 위치와 파일명 선택
4. JSON 파일로 설정이 저장됨

### 설정 불러오기

1. **📂 설정 불러오기** 버튼 클릭
2. 저장된 설정 파일 선택
3. 모든 설정이 자동으로 로드됨

## 📁 출력 파일

-   **파일명 형식**: `{접두사}_{YYYYMMDD_HHMMSS}.xlsx`
-   **예시**: `orders_data_20250108_143022.xlsx`
-   **위치**: 지정한 다운로드 경로
-   **형식**: Excel 파일 (.xlsx)

## 🔧 문제 해결

### 1. 인증 파일 오류

```
❌ 인증 파일을 찾을 수 없습니다!
```

**해결방법:**

-   Google Cloud Console에서 서비스 계정 키를 다시 다운로드
-   파일 경로가 올바른지 확인

### 2. 연결 테스트 실패

```
❌ 연결 테스트 실패: 403 Forbidden
```

**해결방법:**

-   Google Sheets 파일에 서비스 계정 이메일을 편집자로 추가
-   JSON 파일의 `client_email` 값을 확인

### 3. 워크시트를 찾을 수 없음

```
❌ 지정된 워크시트를 찾을 수 없습니다!
```

**해결방법:**

-   워크시트 이름이 정확한지 확인 (대소문자 구분)
-   로그에서 사용 가능한 워크시트 목록 확인

### 4. 라이브러리 오류

```
❌ 필요한 라이브러리가 설치되지 않았습니다!
```

**해결방법:**

```bash
pip install pandas gspread google-auth openpyxl
```

## 🎨 GUI 스크린샷

```
┌─────────────────────────────────────────────────────────────┐
│ 🚀 Google Sheets Orders 데이터 다운로더                    │
├─────────────────────────────────────────────────────────────┤
│ 설정                                                       │
│ 인증 파일:     [credentials.json] [찾기]                   │
│ 스프레드시트 ID: [1M2BURxZ3erydcKwMJcNERUOEyg7EprJoU8r4-brcRoI] │
│ 워크시트 이름: [Orders]                                    │
│ 다운로드 경로: [C:\Downloads] [찾기]                      │
│ 파일명 접두사: [orders_data]                              │
├─────────────────────────────────────────────────────────────┤
│ [🔍 연결 테스트] [📥 데이터 다운로드] [💾 설정 저장] [📂 설정 불러오기] │
├─────────────────────────────────────────────────────────────┤
│ 로그                                                       │
│ [14:30:22] 🔍 연결 테스트 시작...                         │
│ [14:30:25] ✅ 연결 성공! 워크시트 'Orders' 발견           │
│ [14:30:25] 📊 데이터 행 수: 150                           │
│                                                             │
│ 진행 중...                                                 │
└─────────────────────────────────────────────────────────────┘
```

## 🔒 보안 주의사항

-   **인증 파일 보안**: JSON 파일은 민감한 정보를 포함하므로 안전하게 보관
-   **Git 업로드 금지**: `credentials.json` 파일을 Git에 업로드하지 않음
-   **권한 관리**: 서비스 계정에 최소한의 권한만 부여

## 📊 데이터 구조

다운로드되는 데이터는 다음과 같은 컬럼을 포함합니다:

-   주문ID
-   조리원ID
-   PIN
-   상품명
-   수량
-   단가
-   총액
-   날짜
-   배송지
-   수취인
-   연락처

## 🆚 CLI 버전과의 차이점

| 기능          | CLI 버전         | GUI 버전                |
| ------------- | ---------------- | ----------------------- |
| 사용 편의성   | 명령어 입력 필요 | 마우스 클릭으로 간편    |
| 다운로드 경로 | 현재 폴더만      | 원하는 경로 지정 가능   |
| 연결 테스트   | 별도 실행 필요   | 버튼 클릭으로 즉시 확인 |
| 설정 저장     | 수동 편집 필요   | GUI로 저장/불러오기     |
| 실시간 로그   | 콘솔 출력        | GUI 창에서 확인         |
| 멀티스레딩    | 없음             | UI 블로킹 방지          |

## 📝 라이선스

이 프로젝트는 MIT 라이선스 하에 배포됩니다.


