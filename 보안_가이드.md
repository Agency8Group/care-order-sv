# 🔒 조리원 주문 시스템 보안 가이드

## 🚨 중요 보안 취약점 수정 (2025-01-XX)

### 1. 민감한 정보 노출 문제 해결
- **문제**: 로그인 실패 시 다른 조리원들의 ID, PIN, 예산 정보가 모두 노출됨
- **해결**: 디버깅 정보 제거 및 보안 강화된 오류 메시지 적용
- **영향**: 개인정보 보호법 준수 및 보안성 대폭 향상

### 2. 보안 강화 기능 추가
- **로그인 시도 제한**: 최대 5회 실패 시 계정 잠금 (30분)
- **계정 잠금 관리**: 자동 잠금 해제 및 관리자 수동 해제 기능
- **보안 상태 모니터링**: 잠긴 계정 수 및 총 시도 횟수 추적

## 🛡️ 보안 기능 상세

### 로그인 보안
- **최대 시도 횟수**: 5회
- **잠금 시간**: 30분
- **자동 해제**: 시간 경과 후 자동 해제
- **수동 해제**: 관리자 권한으로 즉시 해제 가능

### 보안 모니터링
- **실시간 추적**: 로그인 시도 기록 실시간 저장
- **상태 조회**: `securityStatus` API로 보안 상태 확인
- **로그 기록**: 계정 잠금 이벤트 자동 로깅

## 🔧 API 보안 엔드포인트

### 1. 보안 상태 조회
```
GET /?action=securityStatus
```
**응답 예시:**
```json
{
  "status": "success",
  "message": "보안 상태 조회 완료",
  "lockedAccounts": 2,
  "totalAttempts": 15,
  "totalUsers": 8
}
```

### 2. 로그인 시도 기록 초기화
```
GET /?action=resetLoginAttempts&data={"userId":"사용자ID"}
```
**특정 사용자 초기화**: `userId` 파라미터 포함
**전체 초기화**: `userId` 파라미터 생략

## 📱 프론트엔드 보안 UI

### 보안 상태 표시
- **경고**: 남은 시도 횟수 표시 (노란색)
- **오류**: 계정 잠금 상태 표시 (빨간색)
- **정보**: 일반 보안 메시지 (파란색)

### 자동 숨김
- 로그인 성공 시 자동 숨김
- 로그아웃 시 자동 숨김
- 새 로그인 시도 시 자동 표시

## 🚀 보안 설정 가이드

### 1. Google Apps Script 설정
```javascript
// 보안 설정 상수 (필요시 조정)
const MAX_LOGIN_ATTEMPTS = 5;        // 최대 시도 횟수
const LOCKOUT_DURATION = 30;         // 잠금 시간 (분)
```

### 2. 트리거 설정
```javascript
// 보안 로그 정리 트리거 (선택사항)
function setupSecurityCleanupTrigger() {
  ScriptApp.newTrigger("cleanupOldSecurityLogs")
    .timeBased()
    .everyDays(1)
    .atHour(3)
    .create();
}
```

## ⚠️ 보안 주의사항

### 1. 민감한 정보 보호
- **절대 노출 금지**: 사용자 ID, PIN, 예산 정보
- **디버깅 정보**: 프로덕션 환경에서 완전 제거
- **로그 기록**: 민감한 정보 포함 시 암호화 또는 마스킹

### 2. 접근 제어
- **API 엔드포인트**: 인증된 사용자만 접근 가능
- **관리자 기능**: 보안 상태 조회 및 초기화 기능
- **세션 관리**: 로그아웃 시 모든 데이터 초기화

### 3. 모니터링
- **정기 점검**: 보안 상태 주기적 확인
- **이상 징후**: 비정상적인 로그인 시도 패턴 감지
- **로그 분석**: 보안 이벤트 정기적 분석

## 🔍 보안 테스트 방법

### 1. 로그인 시도 제한 테스트
1. 잘못된 PIN으로 5회 연속 입력
2. 계정 잠금 확인
3. 30분 후 자동 해제 확인

### 2. 보안 상태 조회 테스트
1. `securityStatus` API 호출
2. 잠긴 계정 수 확인
3. 총 시도 횟수 확인

### 3. 관리자 기능 테스트
1. 특정 사용자 계정 잠금 해제
2. 전체 계정 잠금 해제
3. 보안 로그 초기화

## 📞 보안 문의

### 긴급 상황
- **보안 침해 의심**: 즉시 시스템 접근 차단
- **계정 잠금**: 관리자 권한으로 즉시 해제
- **데이터 유출**: 로그 분석 및 영향도 평가

### 정기 점검
- **월 1회**: 보안 상태 전체 점검
- **분기 1회**: 보안 설정 검토 및 업데이트
- **연 1회**: 보안 정책 전면 검토

---

**마지막 업데이트**: 2025-01-XX  
**보안 레벨**: 🔒🔒🔒🔒🔒 (최고)  
**담당자**: 시스템 관리자
